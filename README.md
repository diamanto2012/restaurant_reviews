# Приложение для сбора отзывов о ресторанах

REST API для сбора и управления отзывами о ресторанах. Приложение предоставляет респондентам доступ к списку ресторанов и созданию отзывов, а администраторам - возможности менеджмента ресторанов и выгрузки отчетов.

## Технологии

- Flask
- SQLAlchemy
- Alembic
- JWT-авторизация
- Swagger

## Роли пользователей

### Администратор

- Управление пользователями (CRUD)
- Управление ресторанами (CRUD)
- Выгрузка сводного отчета по всем ресторанам
- Просмотр всех отзывов

### Респондент

- Регистрация и получение своих данных
- Просмотр списка ресторанов
- Создание отзывов (по одному на ресторан)
- Просмотр своих отзывов

## Установка и запуск

1. Клонировать репозиторий:
```
git clone https://github.com/diamanto2012/restaurant_reviews.git
cd test2
```

2. Создать и активировать виртуальное окружение:
```
python -m venv venv
source venv/bin/activate  # для Linux/Mac
venv/Scripts/activate  # для Windows
```

3. Установить зависимости:
```
pip install -r requirements.txt
```

4. Настроить переменные окружения:
# Скопируйте файл-шаблон .env.example в .env
cp .env.example .env  # для Linux/Mac
copy .env.example .env  # для Windows

# Затем отредактируйте файл .env, установив собственные значения

В файле `.env` необходимо настроить следующие переменные:
- `FLASK_APP`: Точка входа в приложение (обычно run.py)
- `FLASK_ENV`: Окружение разработки (development/production)
- `SECRET_KEY`: Секретный ключ для Flask-сессий и безопасности
- `DATABASE_URI`: URI подключения к базе данных
- `JWT_SECRET_KEY`: Секретный ключ для генерации и проверки JWT-токенов

5. Создать базу данных и применить миграции:
```
flask db upgrade
```

6. Запустить приложение:
```
flask run
```

## API Документация

API документация доступна по адресу `/api/docs` после запуска приложения.

### Основные эндпоинты

#### Аутентификация
- `POST /api/v1/auth/register` - Регистрация нового пользователя (респондента)
- `POST /api/v1/auth/login` - Вход в систему (получение JWT токена)

Администратор: username=admin, password=admin123
Респондент: username=user2, password=user123

#### Пользователи
- `GET /api/v1/users` - Получение списка пользователей (только для администраторов)
- `POST /api/v1/users` - Создание нового пользователя (только для администраторов)
- `GET /api/v1/users/{user_id}` - Получение данных пользователя
- `PUT /api/v1/users/{user_id}` - Обновление данных пользователя (только для администраторов)
- `DELETE /api/v1/users/{user_id}` - Удаление пользователя (только для администраторов)

#### Рестораны
- `GET /api/v1/restaurants` - Получение списка ресторанов
- `POST /api/v1/restaurants` - Создание нового ресторана (только для администраторов)
- `GET /api/v1/restaurants/{restaurant_id}` - Получение данных ресторана
- `PUT /api/v1/restaurants/{restaurant_id}` - Обновление данных ресторана (только для администраторов)
- `DELETE /api/v1/restaurants/{restaurant_id}` - Удаление ресторана (только для администраторов)
- `GET /api/v1/restaurants/report` - Выгрузка сводного отчета (только для администраторов)

#### Отзывы
- `GET /api/v1/reviews` - Получение списка отзывов
- `POST /api/v1/reviews` - Создание нового отзыва
- `GET /api/v1/reviews/{review_id}` - Получение данных отзыва
